p8105_hw2_th3147
================
Te-Hsuan Huang
2025-09-27

# Problem 1

1.  First dataset

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.2     ✔ tibble    3.3.0
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
    ## ✔ purrr     1.1.0     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
polsmonth_df = read_csv(file = "./fivethirtyeight_datasets/pols-month.csv") |> 
  janitor::clean_names() |> 
  separate(mon, into = c("year", "month", "day"), sep = "-") |> 
 mutate( 
   year = as.numeric(year),
    month = case_match(
      month,
      "01" ~ "jan",
      "02" ~ "feb",
      "03" ~ "mar",
      "04" ~ "apr",
      "05" ~ "may",
      "06" ~ "jun",
      "07" ~ "jul",
      "08" ~ "aug",
      "09" ~ "sep",
      "10" ~ "oct",
      "11" ~ "nov",
      "12" ~ "dec"
    ), 
    
    president = case_match(
      prez_dem,
      1 ~ "dem",
      0 ~ "gop")) |> 
    select(-prez_dem, -prez_gop, -day)
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
polsmonth_df
```

    ## # A tibble: 822 × 9
    ##     year month gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president
    ##    <dbl> <chr>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>    
    ##  1  1947 jan        23      51     253      23      45     198 dem      
    ##  2  1947 feb        23      51     253      23      45     198 dem      
    ##  3  1947 mar        23      51     253      23      45     198 dem      
    ##  4  1947 apr        23      51     253      23      45     198 dem      
    ##  5  1947 may        23      51     253      23      45     198 dem      
    ##  6  1947 jun        23      51     253      23      45     198 dem      
    ##  7  1947 jul        23      51     253      23      45     198 dem      
    ##  8  1947 aug        23      51     253      23      45     198 dem      
    ##  9  1947 sep        23      51     253      23      45     198 dem      
    ## 10  1947 oct        23      51     253      23      45     198 dem      
    ## # ℹ 812 more rows

- make sure the lower case in month.

2.  second dataset

``` r
snp_df = read_csv(file = "./fivethirtyeight_datasets/snp.csv") |> 
  janitor::clean_names() |> 
  separate(date, into = c("month", "day", "year"), sep = "/") |>
  mutate(
    year = as.integer(paste0("20", year)),
    year = as.numeric(year),
    month = case_match(
      month,
      "1" ~ "jan",
      "2" ~ "feb",
      "3" ~ "mar",
      "4" ~ "apr",
      "5" ~ "may",
      "6" ~ "jun",
      "7" ~ "jul",
      "8" ~ "aug",
      "9" ~ "sep",
      "10" ~ "oct",
      "11" ~ "nov",
      "12" ~ "dec"
    )) |> 
      select(-day) |>
      arrange (year, month) |> 
      relocate(year, month)
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
snp_df
```

    ## # A tibble: 787 × 3
    ##     year month close
    ##    <dbl> <chr> <dbl>
    ##  1  2000 apr   1452.
    ##  2  2000 aug   1518.
    ##  3  2000 dec   1320.
    ##  4  2000 feb   1366.
    ##  5  2000 jan   1394.
    ##  6  2000 jul   1431.
    ##  7  2000 jun   1455.
    ##  8  2000 mar   1499.
    ##  9  2000 may   1421.
    ## 10  2000 nov   1315.
    ## # ℹ 777 more rows

- paste0: is a function in R used to concatenate (join together)
  character strings.

- make sure the lower case in month.

3.  Third dataset

``` r
unemploy_df = read_csv(file = "./fivethirtyeight_datasets/unemployment.csv") |> 
  janitor::clean_names() |> 
  pivot_longer(
    jan:dec,
    names_to = "month", 
    values_to = "unemployment_rate") |> 
  relocate(year, month) |>
  arrange(year, month)
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
unemploy_df
```

    ## # A tibble: 816 × 3
    ##     year month unemployment_rate
    ##    <dbl> <chr>             <dbl>
    ##  1  1948 apr                 3.9
    ##  2  1948 aug                 3.9
    ##  3  1948 dec                 4  
    ##  4  1948 feb                 3.8
    ##  5  1948 jan                 3.4
    ##  6  1948 jul                 3.6
    ##  7  1948 jun                 3.6
    ##  8  1948 mar                 4  
    ##  9  1948 may                 3.5
    ## 10  1948 nov                 3.8
    ## # ℹ 806 more rows

4.  Join the dataset

``` r
final_merged_df = 
   polsmonth_df |>
  left_join(snp_df, by = c("year", "month")) |>
  left_join(unemploy_df, by = c("year", "month"))

final_merged_df
```

    ## # A tibble: 822 × 11
    ##     year month gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president close
    ##    <dbl> <chr>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>
    ##  1  1947 jan        23      51     253      23      45     198 dem          NA
    ##  2  1947 feb        23      51     253      23      45     198 dem          NA
    ##  3  1947 mar        23      51     253      23      45     198 dem          NA
    ##  4  1947 apr        23      51     253      23      45     198 dem          NA
    ##  5  1947 may        23      51     253      23      45     198 dem          NA
    ##  6  1947 jun        23      51     253      23      45     198 dem          NA
    ##  7  1947 jul        23      51     253      23      45     198 dem          NA
    ##  8  1947 aug        23      51     253      23      45     198 dem          NA
    ##  9  1947 sep        23      51     253      23      45     198 dem          NA
    ## 10  1947 oct        23      51     253      23      45     198 dem          NA
    ## # ℹ 812 more rows
    ## # ℹ 1 more variable: unemployment_rate <dbl>

- Keep in mind:

1.  the features of year and month in each dataset should be same.

2.  the alphabet should be exactly same in month.

- The resulting dataset is a time-series data frame created by merging
  three original sources: pols-month.csv, which contains U.S. political
  control data (including the number of Democratic and Republican
  governors and the party of the sitting President); snp.csv, which
  tracks the S&P 500 closing price; and unemployment.csv, which records
  the national unemployment rate. After joining the three files on the
  common keys of year and month, the final merged dataset contains 822
  rows and 11 columns, covering the time span from 1947 to 2015. Key
  variables include the date identifiers (year, month), political
  metrics (gov_gop, rep_dem, president), the financial index (close),
  and the economic indicator (unemployment_rate).

# Problem 2

1.  First dataset

``` r
mrtrash_df = 
  readxl::read_excel("./problem 2/202409 Trash Wheel Collection Data.xlsx"
                     , sheet="Mr. Trash Wheel"
                     , range = "A2:N653") |> 
  janitor::clean_names() |> 
   mutate(
    sports_balls = as.integer(round(as.numeric(`sports_balls`))),
    wheel_name = "Mr. Trash Wheel",
    year=as.numeric(year)
  ) |> 
  select(-dumpster) |> 
  relocate(year, month, wheel_name) |> 
  arrange(date)

mrtrash_df
```

    ## # A tibble: 651 × 14
    ##     year month wheel_name     date                weight_tons volume_cubic_yards
    ##    <dbl> <chr> <chr>          <dttm>                    <dbl>              <dbl>
    ##  1  2014 May   Mr. Trash Whe… 2014-05-16 00:00:00        4.31                 18
    ##  2  2014 May   Mr. Trash Whe… 2014-05-16 00:00:00        2.74                 13
    ##  3  2014 May   Mr. Trash Whe… 2014-05-16 00:00:00        3.45                 15
    ##  4  2014 May   Mr. Trash Whe… 2014-05-17 00:00:00        3.1                  15
    ##  5  2014 May   Mr. Trash Whe… 2014-05-17 00:00:00        4.06                 18
    ##  6  2014 May   Mr. Trash Whe… 2014-05-20 00:00:00        2.71                 13
    ##  7  2014 May   Mr. Trash Whe… 2014-05-21 00:00:00        1.91                  8
    ##  8  2014 May   Mr. Trash Whe… 2014-05-28 00:00:00        3.7                  16
    ##  9  2014 June  Mr. Trash Whe… 2014-06-05 00:00:00        2.52                 14
    ## 10  2014 June  Mr. Trash Whe… 2014-06-11 00:00:00        3.76                 18
    ## # ℹ 641 more rows
    ## # ℹ 8 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, plastic_bags <dbl>,
    ## #   wrappers <dbl>, sports_balls <int>, homes_powered <dbl>

2.  Second dataset

``` r
prtrash_df = 
  readxl::read_excel("./problem 2/202409 Trash Wheel Collection Data.xlsx"
                     , sheet="Professor Trash Wheel"
                     , range = "A2:M120") |> 
  janitor::clean_names() |> 
  mutate(
    wheel_name = "Professor Trash Wheel") |> 
  select(-dumpster) |> 
  relocate(year, month, wheel_name) |> 
  arrange(date)

prtrash_df
```

    ## # A tibble: 118 × 13
    ##     year month    wheel_name  date                weight_tons volume_cubic_yards
    ##    <dbl> <chr>    <chr>       <dttm>                    <dbl>              <dbl>
    ##  1  2017 January  Professor … 2017-01-02 00:00:00        1.79                 15
    ##  2  2017 January  Professor … 2017-01-30 00:00:00        1.58                 15
    ##  3  2017 February Professor … 2017-02-26 00:00:00        2.32                 18
    ##  4  2017 February Professor … 2017-02-26 00:00:00        3.72                 15
    ##  5  2017 February Professor … 2017-02-28 00:00:00        1.45                 15
    ##  6  2017 March    Professor … 2017-03-30 00:00:00        1.71                 15
    ##  7  2017 April    Professor … 2017-04-01 00:00:00        1.82                 15
    ##  8  2017 April    Professor … 2017-04-20 00:00:00        2.37                 15
    ##  9  2017 May      Professor … 2017-05-10 00:00:00        2.64                 15
    ## 10  2017 May      Professor … 2017-05-26 00:00:00        2.78                 15
    ## # ℹ 108 more rows
    ## # ℹ 7 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, plastic_bags <dbl>,
    ## #   wrappers <dbl>, homes_powered <dbl>

3.  Third dataset

``` r
gwtrash_df = 
  readxl::read_excel("./problem 2/202409 Trash Wheel Collection Data.xlsx"
                     , sheet="Gwynnda Trash Wheel"
                     , range = "A2:L265") |> 
  janitor::clean_names() |> 
  mutate(
    wheel_name = "Gwynnda Trash Wheel") |> 
  select(-dumpster) |> 
  relocate(year, month, wheel_name) |> 
  arrange(date)
  
gwtrash_df
```

    ## # A tibble: 263 × 12
    ##     year month  wheel_name    date                weight_tons volume_cubic_yards
    ##    <dbl> <chr>  <chr>         <dttm>                    <dbl>              <dbl>
    ##  1  2021 July   Gwynnda Tras… 2021-07-03 00:00:00        0.93                 15
    ##  2  2021 July   Gwynnda Tras… 2021-07-07 00:00:00        2.26                 15
    ##  3  2021 July   Gwynnda Tras… 2021-07-07 00:00:00        1.62                 15
    ##  4  2021 July   Gwynnda Tras… 2021-07-16 00:00:00        1.76                 15
    ##  5  2021 July   Gwynnda Tras… 2021-07-30 00:00:00        1.53                 15
    ##  6  2021 August Gwynnda Tras… 2021-08-11 00:00:00        2.06                 15
    ##  7  2021 August Gwynnda Tras… 2021-08-14 00:00:00        1.9                  15
    ##  8  2021 August Gwynnda Tras… 2021-08-16 00:00:00        2.16                 15
    ##  9  2021 August Gwynnda Tras… 2021-08-16 00:00:00        2.6                  15
    ## 10  2021 August Gwynnda Tras… 2021-08-17 00:00:00        3.21                 15
    ## # ℹ 253 more rows
    ## # ℹ 6 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, plastic_bags <dbl>, wrappers <dbl>,
    ## #   homes_powered <dbl>

4.  Merge the dataset

``` r
final_merged2_df = 
  bind_rows(mrtrash_df, prtrash_df, gwtrash_df) |>
  janitor::clean_names()

final_merged2_df
```

    ## # A tibble: 1,032 × 14
    ##     year month wheel_name     date                weight_tons volume_cubic_yards
    ##    <dbl> <chr> <chr>          <dttm>                    <dbl>              <dbl>
    ##  1  2014 May   Mr. Trash Whe… 2014-05-16 00:00:00        4.31                 18
    ##  2  2014 May   Mr. Trash Whe… 2014-05-16 00:00:00        2.74                 13
    ##  3  2014 May   Mr. Trash Whe… 2014-05-16 00:00:00        3.45                 15
    ##  4  2014 May   Mr. Trash Whe… 2014-05-17 00:00:00        3.1                  15
    ##  5  2014 May   Mr. Trash Whe… 2014-05-17 00:00:00        4.06                 18
    ##  6  2014 May   Mr. Trash Whe… 2014-05-20 00:00:00        2.71                 13
    ##  7  2014 May   Mr. Trash Whe… 2014-05-21 00:00:00        1.91                  8
    ##  8  2014 May   Mr. Trash Whe… 2014-05-28 00:00:00        3.7                  16
    ##  9  2014 June  Mr. Trash Whe… 2014-06-05 00:00:00        2.52                 14
    ## 10  2014 June  Mr. Trash Whe… 2014-06-11 00:00:00        3.76                 18
    ## # ℹ 1,022 more rows
    ## # ℹ 8 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, plastic_bags <dbl>,
    ## #   wrappers <dbl>, sports_balls <int>, homes_powered <dbl>

- The combined Trash Wheel dataset is a time-series data frame that
  aggregates collection metrics for three different wheels: Mr. Trash
  Wheel, Professor Trash Wheel, and Gwynnda. This dataset contains 1032
  observations, with key variables including the wheel identifier, the
  date, the amount of trash collected by weight, and specific item
  counts like plastic_bottles and cigarette_butts. Analysis of the
  individual wheels shows that the total weight of trash collected by
  Professor Trash Wheel amounts to 246.74 tons. Furthermore, the total
  number of cigarette butts collected by Gwynnda in June of 2022 was
  18,120 butts.

# Problem 3

1.  First dataset

``` r
zipcode_df = read_csv(file = "./zillow_data/Zip Codes.csv") |> 
  janitor::clean_names() |> 
  rename(county_name = county) |> 
  select(-county_fips) |> 
  relocate(zip_code, county_name) |> 
  arrange(zip_code)
```

    ## Rows: 322 Columns: 7
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (4): County, County Code, File Date, Neighborhood
    ## dbl (3): State FIPS, County FIPS, ZipCode
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
zipcode_df
```

    ## # A tibble: 322 × 6
    ##    zip_code county_name state_fips county_code file_date neighborhood           
    ##       <dbl> <chr>            <dbl> <chr>       <chr>     <chr>                  
    ##  1    10001 New York            36 061         7/25/07   Chelsea and Clinton    
    ##  2    10002 New York            36 061         7/25/07   Lower East Side        
    ##  3    10003 New York            36 061         7/25/07   Lower East Side        
    ##  4    10004 New York            36 061         7/25/07   Lower Manhattan        
    ##  5    10005 New York            36 061         7/25/07   Lower Manhattan        
    ##  6    10006 New York            36 061         7/25/07   Lower Manhattan        
    ##  7    10007 New York            36 061         7/25/07   Lower Manhattan        
    ##  8    10008 New York            36 061         7/25/07   <NA>                   
    ##  9    10009 New York            36 061         7/25/07   Lower East Side        
    ## 10    10010 New York            36 061         7/25/07   Gramercy Park and Murr…
    ## # ℹ 312 more rows

2.  Second dataset

``` r
rental_df = read_csv(file = "./zillow_data/Zip_zori_uc_sfrcondomfr_sm_month_NYC.csv") |> 
  janitor::clean_names() |> 
  pivot_longer(
    x2015_01_31:x2024_08_31,
    names_to = "rental_date", 
    values_to = "rental_price") |> 
  mutate(
    county_name = stringr::str_replace(county_name, " County", ""),
    rental_date = stringr::str_replace(rental_date, "x", "")
  ) |> 
  separate(rental_date, into = c("year", "month", "day"), sep = "_") |> 
  mutate(
    month = case_match(
      month,
      "01" ~ "jan",
      "02" ~ "feb",
      "03" ~ "mar",
      "04" ~ "apr",
      "05" ~ "may",
      "06" ~ "jun",
      "07" ~ "jul",
      "08" ~ "aug",
      "09" ~ "sep",
      "10" ~ "oct",
      "11" ~ "nov",
      "12" ~ "dec"
    ),
    year=as.integer(year),
    day=as.integer(day)) |> 
  rename(zip_code = region_name) |> 
  relocate(zip_code, county_name) |> 
  select(-state, -region_type) |> 
  arrange(zip_code)
```

    ## Rows: 149 Columns: 125
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr   (6): RegionType, StateName, State, City, Metro, CountyName
    ## dbl (119): RegionID, SizeRank, RegionName, 2015-01-31, 2015-02-28, 2015-03-3...
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
rental_df
```

    ## # A tibble: 17,284 × 11
    ##    zip_code county_name region_id size_rank state_name city    metro  year month
    ##       <dbl> <chr>           <dbl>     <dbl> <chr>      <chr>   <chr> <int> <chr>
    ##  1    10001 New York        61615      4444 NY         New Yo… New …  2015 jan  
    ##  2    10001 New York        61615      4444 NY         New Yo… New …  2015 feb  
    ##  3    10001 New York        61615      4444 NY         New Yo… New …  2015 mar  
    ##  4    10001 New York        61615      4444 NY         New Yo… New …  2015 apr  
    ##  5    10001 New York        61615      4444 NY         New Yo… New …  2015 may  
    ##  6    10001 New York        61615      4444 NY         New Yo… New …  2015 jun  
    ##  7    10001 New York        61615      4444 NY         New Yo… New …  2015 jul  
    ##  8    10001 New York        61615      4444 NY         New Yo… New …  2015 aug  
    ##  9    10001 New York        61615      4444 NY         New Yo… New …  2015 sep  
    ## 10    10001 New York        61615      4444 NY         New Yo… New …  2015 oct  
    ## # ℹ 17,274 more rows
    ## # ℹ 2 more variables: day <int>, rental_price <dbl>
