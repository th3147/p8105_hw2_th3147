p8105_hw2_th3147
================
Te-Hsuan Huang
2025-09-27

# Problem 1

1.  First dataset

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.2     ✔ tibble    3.3.0
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
    ## ✔ purrr     1.1.0     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
polsmonth_df = read_csv(file = "./fivethirtyeight_datasets/pols-month.csv") |> 
  janitor::clean_names() |> 
  separate(mon, into = c("year", "month", "day"), sep = "-") |> 
 mutate( 
   year = as.numeric(year),
    month = case_match(
      month,
      "01" ~ "jan",
      "02" ~ "feb",
      "03" ~ "mar",
      "04" ~ "apr",
      "05" ~ "may",
      "06" ~ "jun",
      "07" ~ "jul",
      "08" ~ "aug",
      "09" ~ "sep",
      "10" ~ "oct",
      "11" ~ "nov",
      "12" ~ "dec"
    ), 
    
    president = case_match(
      prez_dem,
      1 ~ "dem",
      0 ~ "gop")) |> 
    select(-prez_dem, -prez_gop, -day)
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
polsmonth_df
```

    ## # A tibble: 822 × 9
    ##     year month gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president
    ##    <dbl> <chr>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>    
    ##  1  1947 jan        23      51     253      23      45     198 dem      
    ##  2  1947 feb        23      51     253      23      45     198 dem      
    ##  3  1947 mar        23      51     253      23      45     198 dem      
    ##  4  1947 apr        23      51     253      23      45     198 dem      
    ##  5  1947 may        23      51     253      23      45     198 dem      
    ##  6  1947 jun        23      51     253      23      45     198 dem      
    ##  7  1947 jul        23      51     253      23      45     198 dem      
    ##  8  1947 aug        23      51     253      23      45     198 dem      
    ##  9  1947 sep        23      51     253      23      45     198 dem      
    ## 10  1947 oct        23      51     253      23      45     198 dem      
    ## # ℹ 812 more rows

- make sure the lower case in month.

2.  second dataset

``` r
snp_df = read_csv(file = "./fivethirtyeight_datasets/snp.csv") |> 
  janitor::clean_names() |> 
  separate(date, into = c("month", "day", "year"), sep = "/") |>
  mutate(
    year = as.integer(paste0("20", year)),
    year = as.numeric(year),
    month = case_match(
      month,
      "1" ~ "jan",
      "2" ~ "feb",
      "3" ~ "mar",
      "4" ~ "apr",
      "5" ~ "may",
      "6" ~ "jun",
      "7" ~ "jul",
      "8" ~ "aug",
      "9" ~ "sep",
      "10" ~ "oct",
      "11" ~ "nov",
      "12" ~ "dec"
    )) |> 
      select(-day) |>
      arrange (year, month) |> 
      relocate(year, month)
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
snp_df
```

    ## # A tibble: 787 × 3
    ##     year month close
    ##    <dbl> <chr> <dbl>
    ##  1  2000 apr   1452.
    ##  2  2000 aug   1518.
    ##  3  2000 dec   1320.
    ##  4  2000 feb   1366.
    ##  5  2000 jan   1394.
    ##  6  2000 jul   1431.
    ##  7  2000 jun   1455.
    ##  8  2000 mar   1499.
    ##  9  2000 may   1421.
    ## 10  2000 nov   1315.
    ## # ℹ 777 more rows

- paste0: is a function in R used to concatenate (join together)
  character strings.

- make sure the lower case in month.

3.  Third dataset

``` r
unemploy_df = read_csv(file = "./fivethirtyeight_datasets/unemployment.csv") |> 
  janitor::clean_names() |> 
  pivot_longer(
    jan:dec,
    names_to = "month", 
    values_to = "unemployment_rate") |> 
  relocate(year, month) |>
  arrange(year, month)
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
unemploy_df
```

    ## # A tibble: 816 × 3
    ##     year month unemployment_rate
    ##    <dbl> <chr>             <dbl>
    ##  1  1948 apr                 3.9
    ##  2  1948 aug                 3.9
    ##  3  1948 dec                 4  
    ##  4  1948 feb                 3.8
    ##  5  1948 jan                 3.4
    ##  6  1948 jul                 3.6
    ##  7  1948 jun                 3.6
    ##  8  1948 mar                 4  
    ##  9  1948 may                 3.5
    ## 10  1948 nov                 3.8
    ## # ℹ 806 more rows

4.  Join the dataset

``` r
final_merged_df = 
  polsmonth_df |>
  left_join(snp_df, by = c("year", "month")) |>
  left_join(unemploy_df, by = c("year", "month"))

final_merged_df
```

    ## # A tibble: 822 × 11
    ##     year month gov_gop sen_gop rep_gop gov_dem sen_dem rep_dem president close
    ##    <dbl> <chr>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl>   <dbl> <chr>     <dbl>
    ##  1  1947 jan        23      51     253      23      45     198 dem          NA
    ##  2  1947 feb        23      51     253      23      45     198 dem          NA
    ##  3  1947 mar        23      51     253      23      45     198 dem          NA
    ##  4  1947 apr        23      51     253      23      45     198 dem          NA
    ##  5  1947 may        23      51     253      23      45     198 dem          NA
    ##  6  1947 jun        23      51     253      23      45     198 dem          NA
    ##  7  1947 jul        23      51     253      23      45     198 dem          NA
    ##  8  1947 aug        23      51     253      23      45     198 dem          NA
    ##  9  1947 sep        23      51     253      23      45     198 dem          NA
    ## 10  1947 oct        23      51     253      23      45     198 dem          NA
    ## # ℹ 812 more rows
    ## # ℹ 1 more variable: unemployment_rate <dbl>

- Keep in mind:

1.  the features of year and month in each dataset should be same.

2.  the alphabet should be exactly same in month.

- The resulting dataset is a time-series data frame created by merging
  three original sources: pols-month.csv, which contains U.S. political
  control data (including the number of Democratic and Republican
  governors and the party of the sitting President); snp.csv, which
  tracks the S&P 500 closing price; and unemployment.csv, which records
  the national unemployment rate. After joining the three files on the
  common keys of year and month, the final merged dataset contains 822
  rows and 11 columns, covering the time span from 1947 to 2015. Key
  variables include the date identifiers (year, month), political
  metrics (gov_gop, rep_dem, president), the financial index (close),
  and the economic indicator (unemployment_rate).

# Problem 2

1.  First dataset

``` r
mrtrash_df = 
  readxl::read_excel("./problem 2/202409 Trash Wheel Collection Data.xlsx"
                     , sheet="Mr. Trash Wheel"
                     , range = "A2:N653") |> 
  janitor::clean_names() |> 
   mutate(
    sports_balls = as.integer(round(as.numeric(`sports_balls`))) 
  )

mrtrash_df
```

    ## # A tibble: 651 × 14
    ##    dumpster month year  date                weight_tons volume_cubic_yards
    ##       <dbl> <chr> <chr> <dttm>                    <dbl>              <dbl>
    ##  1        1 May   2014  2014-05-16 00:00:00        4.31                 18
    ##  2        2 May   2014  2014-05-16 00:00:00        2.74                 13
    ##  3        3 May   2014  2014-05-16 00:00:00        3.45                 15
    ##  4        4 May   2014  2014-05-17 00:00:00        3.1                  15
    ##  5        5 May   2014  2014-05-17 00:00:00        4.06                 18
    ##  6        6 May   2014  2014-05-20 00:00:00        2.71                 13
    ##  7        7 May   2014  2014-05-21 00:00:00        1.91                  8
    ##  8        8 May   2014  2014-05-28 00:00:00        3.7                  16
    ##  9        9 June  2014  2014-06-05 00:00:00        2.52                 14
    ## 10       10 June  2014  2014-06-11 00:00:00        3.76                 18
    ## # ℹ 641 more rows
    ## # ℹ 8 more variables: plastic_bottles <dbl>, polystyrene <dbl>,
    ## #   cigarette_butts <dbl>, glass_bottles <dbl>, plastic_bags <dbl>,
    ## #   wrappers <dbl>, sports_balls <int>, homes_powered <dbl>
